<!DOCTYPE html>
<html lang="ar" dir="rtl" data-theme="light">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>9esati - ูุตุต ูุบุฑุจูุฉ ุจุงูุฏุงุฑุฌุฉ</title>
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@300;400;500;700;800&display=swap" rel="stylesheet">
    <link rel="icon" type="image/x-icon" href="https://cdn-icons-png.flaticon.com/512/2237/2237987.png">
    <!-- PWA Manifest -->
    <link rel="manifest" href="manifest.json">
    <meta name="theme-color" content="#6a11cb">
</head>
<body>
    <!-- ุดุฑูุท ุงูุชูุจูู -->
    <div class="site-notice">
        <p><i class="fas fa-star"></i> ูุฑุญุจุงู ุจูู ูู <strong>9esati</strong> - ุฃูู ููุตุฉ ูุบุฑุจูุฉ ูููุตุต ุจุงูุฏุงุฑุฌุฉ</p>
    </div>

    <!-- ุงูููุฏุฑ -->
    <header>
        <nav>
            <div class="logo">
                <i class="fas fa-book-open"></i>
                <div class="logo-text">
                    <h1>9esati</h1>
                    <p class="tagline">ูุตุต ูุบุฑุจูุฉ ุฃุตููุฉ ุจุงูุฏุงุฑุฌุฉ</p>
                </div>
            </div>

            <!-- ุดุฑูุท ุงูุจุญุซ -->
            <div class="search-container">
                <input type="text" id="search-input" placeholder="ุงุจุญุซ ูู ุงููุตุต...">
                <button id="search-btn" class="btn-search">
                    <i class="fas fa-search"></i>
                </button>
                <button id="clear-search" class="btn-clear" style="display: none;">
                    <i class="fas fa-times"></i>
                </button>
            </div>

            <!-- ุฒุฑ ุชุจุฏูู ุงููุถุน ุงูุฏุงูู/ุงููุงุชุญ -->
            <div class="theme-toggle">
                <button id="theme-toggle-btn" class="btn-outline" title="ุชุจุฏูู ุงููุถุน ุงูุฏุงูู/ุงููุงุชุญ">
                    <i class="fas fa-moon"></i>
                    <span class="theme-text">ุฏุงูู</span>
                </button>
            </div>

            <!-- ุนูุงุตุฑ ุงูุชุญูู ุจุงููุณุชุฎุฏู -->
            <div class="auth-controls">
                <div id="guest-view">
                    <button id="login-btn" class="btn-outline">
                        <i class="fas fa-sign-in-alt"></i> ุฏุฎูู
                    </button>
                    <button id="register-btn" class="btn-primary">
                        <i class="fas fa-user-plus"></i> ุญุณุงุจ ุฌุฏูุฏ
                    </button>
                </div>
                
                <div id="user-view" style="display: none;">
                    <span id="user-email"></span>
                    <button id="logout-btn" class="btn-outline">
                        <i class="fas fa-sign-out-alt"></i> ุฎุฑูุฌ
                    </button>
                    <button id="add-story-btn" class="btn-primary">
                        <i class="fas fa-plus"></i> ูุตุฉ ุฌุฏูุฏุฉ
                    </button>
                </div>
            </div>
        </nav>
    </header>

    <!-- ูุงูุฐุฉ ุชุณุฌูู ุงูุฏุฎูู -->
    <div id="loginModal" class="modal">
        <div class="modal-content">
            <span class="close-modal">&times;</span>
            <h2><i class="fas fa-sign-in-alt"></i> ุชุณุฌูู ุงูุฏุฎูู</h2>
            <input type="email" id="loginEmail" placeholder="ุงูุจุฑูุฏ ุงูุฅููุชุฑููู">
            <input type="password" id="loginPassword" placeholder="ูููุฉ ุงููุฑูุฑ">
            <button id="doLogin" class="btn-primary">ุฏุฎูู</button>
            <p class="modal-link">ููุณ ูุฏูู ุญุณุงุจุ <a href="#" id="switch-to-register">ุณุฌู ุงูุขู</a></p>
        </div>
    </div>

    <!-- ูุงูุฐุฉ ุงูุชุณุฌูู -->
    <div id="registerModal" class="modal">
        <div class="modal-content">
            <span class="close-modal">&times;</span>
            <h2><i class="fas fa-user-plus"></i> ุฅูุดุงุก ุญุณุงุจ</h2>
            <input type="email" id="registerEmail" placeholder="ุงูุจุฑูุฏ ุงูุฅููุชุฑููู">
            <input type="password" id="registerPassword" placeholder="ูููุฉ ุงููุฑูุฑ (6 ุฃุญุฑู ุนูู ุงูุฃูู)">
            <button id="doRegister" class="btn-primary">ุฅูุดุงุก ุญุณุงุจ</button>
        </div>
    </div>

    <!-- ุงููุญุชูู ุงูุฑุฆูุณู -->
    <main class="container">
        <!-- ูุณู ุงูุจุทู -->
        <section class="hero">
            <h2>ุดุงุฑู ูุตุชู ุจุงูุฏุงุฑุฌุฉ ุงููุบุฑุจูุฉ</h2>
            <p>ููุตุฉ ูุบุฑุจูุฉ ุฎุงูุตุฉ ูููุตุต ุจุงูุฏุงุฑุฌุฉ - ุงูุชุจ ูุตุชูุ ุดุงุฑููุง ูุน ุงูุนุงูู</p>
            <div class="hero-stats">
                <div class="stat">
                    <i class="fas fa-book"></i>
                    <span class="count" id="stories-count">0</span>
                    <span class="label">ูุตุฉ</span>
                </div>
                <div class="stat">
                    <i class="fas fa-users"></i>
                    <span class="count" id="users-count">0</span>
                    <span class="label">ูุงุชุจ</span>
                </div>
                <div class="stat">
                    <i class="fas fa-eye"></i>
                    <span class="count" id="views-count">0</span>
                    <span class="label">ูุฑุงุกุฉ</span>
                </div>
            </div>
            <button id="start-writing" class="btn-primary btn-large">
                <i class="fas fa-pen"></i> ุงุจุฏุฃ ุงููุชุงุจุฉ ุงูุขู
            </button>
        </section>

        <!-- ุฃุญุฏุซ ุงููุตุต -->
        <section class="stories-section">
            <div class="section-header">
                <h2><i class="fas fa-clock"></i> ุฃุญุฏุซ ุงููุตุต</h2>
                <div class="section-actions">
                    <button id="refresh-stories" class="btn-outline">
                        <i class="fas fa-sync-alt"></i> ุชุญุฏูุซ
                    </button>
                </div>
            </div>
            
            <div class="stories-container" id="stories-container">
                <!-- ููุง ุณุชุธูุฑ ุงููุตุต -->
                <div class="loading">
                    <i class="fas fa-spinner fa-spin"></i>
                    <p>ุฌุงุฑู ุชุญููู ุงููุตุต...</p>
                </div>
            </div>
        </section>

        <!-- ููู ุชุนูู -->
        <section class="how-it-works">
            <h2><i class="fas fa-play-circle"></i> ููู ุชุนูู ููุตุชูุงุ</h2>
            <div class="steps">
                <div class="step">
                    <div class="step-number">1</div>
                    <h3>ุณุฌูู ุญุณุงุจุงู</h3>
                    <p>ุฃูุดุฆ ุญุณุงุจู ุงููุฌุงูู ูู ุซูุงูู</p>
                </div>
                <div class="step">
                    <div class="step-number">2</div>
                    <h3>ุงูุชุจ ูุตุชู</h3>
                    <p>ุงูุชุจ ุจุงูุฏุงุฑุฌุฉ ุงููุบุฑุจูุฉ ุจุทูุงูุฉ</p>
                </div>
                <div class="step">
                    <div class="step-number">3</div>
                    <h3>ุงูุดุฑ ูุดุงุฑู</h3>
                    <p>ุงูุดุฑ ูุตุชู ููุฌููุน ูุดุงุฑููุง</p>
                </div>
            </div>
        </section>
    </main>

    <!-- ุตูุญุฉ ุงููุตุฉ ุงููุงููุฉ -->
    <div id="story-detail-page" style="display: none;">
        <div class="container">
            <button id="back-to-home" class="back-btn">
                <i class="fas fa-arrow-left"></i> ุงูุนูุฏุฉ ููุฑุฆูุณูุฉ
            </button>
            
            <article class="story-full">
                <header class="story-header-detail">
                    <h1 id="story-detail-title"></h1>
                    <div class="story-meta-detail">
                        <span class="author" id="story-detail-author">
                            <i class="fas fa-user-pen"></i> <span id="author-name"></span>
                        </span>
                        <span class="date" id="story-detail-date">
                            <i class="fas fa-calendar-days"></i> <span id="story-date"></span>
                        </span>
                        <span class="category" id="story-detail-category">
                            <i class="fas fa-tag"></i> <span id="story-category"></span>
                        </span>
                        <span class="views" id="story-detail-views">
                            <i class="fas fa-eye"></i> <span id="story-views">0</span> ูุดุงูุฏุฉ
                        </span>
                    </div>
                </header>
                
                <!-- ูุธุงู ุงูุชูููู ุจุงููุฌูู -->
                <div class="rating-section" id="rating-section">
                    <h3><i class="fas fa-star"></i> ุชูููู ุงููุตุฉ</h3>
                    <div class="stars-container" id="stars-container">
                        <!-- ุงููุฌูู ุณุชุธูุฑ ููุง -->
                    </div>
                    <div class="rating-info">
                        <span id="average-rating">0.0</span>
                        <span class="rating-count" id="rating-count">(0 ุชูููู)</span>
                    </div>
                </div>
                
                <!-- ุชููู ุงูุฃุฌุฒุงุก (ูููุตุต ุงููุชุนุฏุฏุฉ) -->
                <div class="parts-navigation" id="parts-navigation" style="display: none;">
                    <button class="part-btn" id="prev-part-btn" disabled>
                        <i class="fas fa-chevron-right"></i> ุงูุฌุฒุก ุงูุณุงุจู
                    </button>
                    <div class="parts-indicator" id="parts-indicator">
                        ุงูุฌุฒุก <span id="current-part">1</span> ูู <span id="total-parts">1</span>
                    </div>
                    <button class="part-btn" id="next-part-btn">
                        ุงูุฌุฒุก ุงูุชุงูู <i class="fas fa-chevron-left"></i>
                    </button>
                </div>
                
                <!-- ูุญุชูู ุงููุตุฉ ูุน ุญูุงูุฉ ุงููุณุฎ -->
                <div class="story-content-detail" id="story-detail-content" 
                     oncopy="return false" 
                     oncut="return false" 
                     onpaste="return false"
                     oncontextmenu="return false">
                    <!-- ูุญุชูู ุงููุตุฉ ุณูุธูุฑ ููุง -->
                </div>
                
                <!-- ุฑุณุงูุฉ ุญูุงูุฉ ุญููู ุงููุดุฑ -->
                <div id="copy-protection-message" class="protection-message">
                    <i class="fas fa-shield-alt"></i>
                    <p>ุญูุงูุฉ ุญููู ุงููุดุฑ: ูุง ูุณูุญ ุจูุณุฎ ุฃู ูุดุงุฑูุฉ ูุฐู ุงููุตุฉ ุฏูู ุฅุฐู ุงููุงุชุจ.</p>
                </div>
                
                <footer class="story-footer-detail">
                    <div class="story-actions-detail">
                        <button class="btn-like" id="like-story-btn">
                            <i class="far fa-heart"></i>
                            <span id="likes-count">0</span> ุฅุนุฌุงุจ
                        </button>
                        <button class="btn-share" id="share-story-btn">
                            <i class="fas fa-share-alt"></i> ูุดุงุฑูุฉ
                        </button>
                        <!-- ุฃุฒุฑุงุฑ ุงูุชุนุฏูู ูุงูุญุฐู ุณุชุธูุฑ ููุง -->
                    </div>
                </footer>
            </article>
            
            <!-- ูุณู ุงูุชุนูููุงุช -->
            <section class="comments-section">
                <h3><i class="fas fa-comments"></i> ุงูุชุนูููุงุช (<span id="comments-count">0</span>)</h3>
                
                <!-- ูููุฐุฌ ุฅุถุงูุฉ ุชุนููู -->
                <form id="add-comment-form" class="comment-form">
                    <textarea id="comment-text" placeholder="ุงูุชุจ ุชุนูููู ููุง..." rows="3" required></textarea>
                    <button type="submit" class="btn-primary">
                        <i class="fas fa-paper-plane"></i> ุฅุฑุณุงู ุงูุชุนููู
                    </button>
                </form>
                
                <!-- ูุงุฆูุฉ ุงูุชุนูููุงุช -->
                <div id="comments-list" class="comments-list">
                    <!-- ุงูุชุนูููุงุช ุณุชุธูุฑ ููุง -->
                </div>
            </section>
        </div>
    </div>

    <!-- ุงูููุชุฑ -->
    <footer>
        <div class="footer-content">
            <div class="footer-logo">
                <i class="fas fa-book-open"></i>
                <h3>9esati</h3>
            </div>
            <p class="footer-tagline">ููุตุฉ ุงููุตุต ุงููุบุฑุจูุฉ ุจุงูุฏุงุฑุฌุฉ - 100% ูุบุฑุจูุฉ</p>
            <div class="footer-links">
                <a href="#" onclick="showToast('ูุฑูุจุงู...', 'info')"><i class="fas fa-question-circle"></i> ุงููุณุงุนุฏุฉ</a>
                <a href="#" onclick="showToast('ุณูุงุณุฉ ุงูุฎุตูุตูุฉ ูุฑูุจุงู', 'info')"><i class="fas fa-shield-alt"></i> ุงูุฎุตูุตูุฉ</a>
                <a href="#" onclick="showToast('ุงุชุตู ุจูุง ุนุจุฑ ุงูุจุฑูุฏ ุงูุฅููุชุฑููู', 'info')"><i class="fas fa-envelope"></i> ุงุชุตู ุจูุง</a>
            </div>
            <p class="copyright">ยฉ <span id="current-year">2024</span> ูุตุตู - ุตูุน ุจุญุจ ูู ุงููุบุฑุจ ๐ฒ๐ฆ</p>
        </div>
    </footer>

    <!-- ูููุงุช ุงูุฌุงูุงุณูุฑูุจุช -->
    <script type="module" src="firebase-config.js"></script>
    <script type="module" src="script.js"></script>
    
    <!-- PWA Service Worker -->
    <script>
        // ุชุณุฌูู Service Worker
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('sw.js')
                    .then(reg => console.log('โ Service Worker ูุณุฌู:', reg))
                    .catch(err => console.error('โ ุฎุทุฃ ูู Service Worker:', err));
            });
        }
        
        // ุทูุจ ุฅุฐู ุงูุฅุดุนุงุฑุงุช
        function requestNotificationPermission() {
            if ('Notification' in window && Notification.permission === 'default') {
                Notification.requestPermission().then(permission => {
                    if (permission === 'granted') {
                        console.log('โ ุชู ุชูุนูู ุงูุฅุดุนุงุฑุงุช');
                        localStorage.setItem('notifications-enabled', 'true');
                    }
                });
            }
        }
        
        // ุนูุฏ ุชุญููู ุงูุตูุญุฉุ ุทูุจ ุงูุฅุฐู (ููููู ุชุนุฏูู ุงูููุช)
        window.addEventListener('load', () => {
            setTimeout(requestNotificationPermission, 3000);
        });
    </script>
</body>
</html>